<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Lesson 6: Plotting with ggplot, part 1</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Collaborative and Reproducible Data Science in R</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="syllabus.html">Syllabus</a>
</li>
<li>
  <a href="installation.html">Installation</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Lectures
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Lecture notes</li>
    <li>
      <a href="lesson1-rstudio.html">Lesson 1: R Studio</a>
    </li>
    <li>
      <a href="lesson2-rmarkdown-github.html">Lesson 2: RMarkdown and GitHub</a>
    </li>
    <li>
      <a href="lesson3-version-control.html">Lesson 3: Version Control</a>
    </li>
    <li>
      <a href="lesson4-collaboration.html">Lesson 4: Collaborating with GitHub</a>
    </li>
    <li>
      <a href="lesson5-collaboration-part2.html">Lesson 5: Collaborating and Making Websites</a>
    </li>
    <li>
      <a href="lesson6-ggplot-part1.html">Lesson 6: Plotting with ggplot, part 1</a>
    </li>
    <li>
      <a href="lesson7-ggplot-part2.html">Lesson 7: ggplot, part 2</a>
    </li>
    <li>
      <a href="lesson8-tidy-data.html">Lesson 8: Tidy Data</a>
    </li>
  </ul>
</li>
<li>
  <a href="assignments.html">Assignments</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Lesson 6: Plotting with ggplot, part 1</h1>

</div>


<p><br></p>
<div id="readings" class="section level2">
<h2>Readings</h2>
<p><strong>Required</strong>:</p>
<ul>
<li><a href="https://r4ds.had.co.nz/data-visualisation.html">Chapter 3.1-3.6 in Grolemund and Wickham’s R for Data Science</a></li>
</ul>
<p><strong>Additional resources</strong>:</p>
<ul>
<li><a href="https://github.com/rstudio/cheatsheets/blob/master/data-visualization-2.1.pdf">RStudio’s ggplot2 cheat sheet</a></li>
</ul>
<p><br></p>
</div>
<div id="learning-objectives" class="section level2">
<h2>Learning objectives</h2>
<p>By the end of this class you will be able to:</p>
<ul>
<li>Inspect your data in RStudio<br />
</li>
<li>Build several common types of graphs in <code>ggplot2</code><br />
</li>
<li>Customize <code>ggplot2</code> aesthetics<br />
</li>
<li>Combine compatible graph types<br />
</li>
<li>Split up data into faceted graphs<br />
</li>
<li>Change the theme of graphs<br />
</li>
<li>Get more comfortable with sharing your work through GitHub</li>
</ul>
<p><strong>Acknowledgements</strong>: Some content from today’s lecture is adapted from the excellent <a href="https://rstudio-conf-2020.github.io/r-for-excel/">R for Excel users</a> course by Julia Stewart Lowndes and Allison Horst and the <a href="https://r4ds.had.co.nz/data-visualisation.html">R for Data Science</a> book by Garrett Grolemund and Hadley Wickham.</p>
<p><br></p>
</div>
<div id="taking-notes" class="section level2">
<h2>Taking notes</h2>
<div id="create-an-rmarkdown-file-for-note-taking-in-this-lecture" class="section level3">
<h3>Create an RMarkdown file for note taking in this lecture</h3>
<p>Before we start, please open the R Project that you created in our last lecture that is associated with your personal GitHub repository. Then create a new RMarkdown file, select <code>github_document</code> output format, and save it to your lecture note folder. You will use this RMarkdown file to take notes and work on exercises, and to share your work with the class.</p>
<p><br></p>
</div>
</div>
<div id="load-packages" class="section level2">
<h2>Load packages</h2>
<pre class="r"><code>library(tidyverse)</code></pre>
<p><br></p>
</div>
<div id="grammar-of-graphics-in-ggplot2" class="section level2">
<h2>Grammar of graphics in <code>ggplot2</code></h2>
<p>In this class, we will write reproducible code to build graphs piece-by-piece. In Excel, graphs are made by manually selecting options, which may not be the best option for keeping track of our work. Also, if we haven’t built a graph with reproducible code, we might not be able to easily recreate a graph or use that code again to make the same style graph with different data.</p>
<p>Using <code>ggplot2</code>, the graphics package within the <code>tidyverse</code>, we will write reproducible code to manually and thoughtfully build our graphs.</p>
<blockquote>
<p>“ggplot2 implements the grammar of graphics, a coherent system for describing and building graphs. With ggplot2, you can do more faster by learning one system and applying it in many places.” - R4DS</p>
</blockquote>
<p>So yeah…that <code>gg</code> is from “grammar of graphics.”</p>
<p><img src="https://rstudio-conf-2020.github.io/r-for-excel/img/rstudio-cheatsheet-ggplot.png" /></p>
<p>These “same few components” that all <code>ggplot2</code> graphs share include the followings:</p>
<p><img src="https://cxlabsblog.files.wordpress.com/2017/10/2017-10-24-14_36_29-visualization-layers-of-ggplot-google-docs.png" /></p>
<p>Of these, <strong>data</strong>, <strong>aethetics</strong>, and <strong>geometries</strong> are the components that must be specified when creating a graph.</p>
<p>We will use the <code>ggplot2</code> package, but the function we use to initialize a graph will be <code>ggplot</code>, which works best for data in tidy format (i.e., a column for every variable, and a row for every observation). We will learn more about the tidy format and how to convert “untidy” datasets into tidy format later in the class. For the purpose of this class, the datasets that we will use are already in tidy format.</p>
<p>Graphics with <code>ggplot2</code> are built step-by-step, adding new elements as layers with a plus sign (<code>+</code>) between layers. Adding layers in this fashion allows for extensive flexibility and customization of plots. Below is a template that can be used to create almost any graph that you can imagine using <code>ggplot2</code>.</p>
<pre><code>ggplot(data = &lt;DATA&gt;) + 
  &lt;GEOM_FUNCTION&gt;(
     mapping = aes(&lt;MAPPINGS&gt;),
     stat = &lt;STAT&gt;, 
     position = &lt;POSITION&gt;
  ) +
  &lt;COORDINATE_FUNCTION&gt; +
  &lt;FACET_FUNCTION&gt; +
  &lt;THEME_FUNCTION&gt;</code></pre>
<p>Breaking that down:</p>
<ul>
<li>First, tell R you are using <code>ggplot()</code><br />
</li>
<li>Then, tell it the object name under which your data table is stored (<code>data = &lt;DATA&gt;</code>)<br />
</li>
<li>Next, add a layer for the type of geometric object with <code>&lt;GEOM_FUNCTION&gt;</code>. For example, geom_point() generates a scatterplot, geom_line() generates a line graph, geom_bar() generates a bar graph, etc.<br />
</li>
<li>Then, use <code>mapping = aes(&lt;MAPPINGS&gt;)</code> to specify which variables you want to plot in this layer and which aesthetics they should map to.</li>
<li>(Optional) Use <code>stat = &lt;STAT&gt;</code> to perform statistical transformation with your variables.</li>
<li>(Optional) Use <code>position = &lt;POSITION&gt;</code> to perform any position adjustment with your geometric object.</li>
<li>(Optional) Use <code>&lt;COORDINATE_FUNCTION&gt;</code> to change the default coordinate system.</li>
<li>(Optional) Use <code>&lt;FACET_FUNCTION&gt;</code> to make a faceted graph.</li>
<li>(Optional) Use <code>&lt;THEME_FUNCTION&gt;</code> to change the default style of the graph.</li>
</ul>
<p><br></p>
</div>
<div id="activity" class="section level2">
<h2>Activity</h2>
<div id="break-down-the-following-graphs-into-basic-ggplot2-components" class="section level3">
<h3>Break down the following graphs into basic <code>ggplot2</code> components</h3>
<ul>
<li>Manhattan plot</li>
</ul>
<p><img src="https://www.r-graph-gallery.com/img/graph/101_Manhattan_plot.png" /></p>
<ul>
<li>Ridgeline plot</li>
</ul>
<p><img src="https://www.r-graph-gallery.com/294-basic-ridgeline-plot_files/figure-html/unnamed-chunk-1-1.png" /></p>
<ul>
<li>Line plot</li>
</ul>
<p><img src="https://www.r-graph-gallery.com/img/graph/lineplot-spaghetti3.png" /></p>
<ul>
<li>Bar plot</li>
</ul>
<p><img src="https://github.com/nt246/NTRES6940-data-science/raw/master/misc/pre_course_survey_results_files/figure-markdown_github/unnamed-chunk-9-1.png" /></p>
<p><br></p>
</div>
</div>
<div id="create-our-first-ggplot2-graph" class="section level2">
<h2>Create our first <code>ggplot2</code> graph</h2>
<p>We will visualize some fuel economy data for 38 popular models of car using the dataset <code>mpg</code> which is included in the <code>ggplot2</code> package.</p>
<div id="inspect-the-data-frame" class="section level4">
<h4>Inspect the data frame</h4>
<p>Before making any kind of graph, we will always need to know our data first. In R, data tables are most often stored as an object of the class <code>data.frame</code>. There are a few different ways to inspect these data tables.</p>
<ul>
<li><p>Directly type the name of the data frame</p>
<p>This method works well if you run it from RMardown. If ran on R Console or if knitted on RMardkown, it can still do a good job with small data frames, or with data frames that are of the class <code>tibble</code>. (We will learn more about <code>tibble</code> later in class. For now, just think of it as an upgraded type of data frame.)</p>
<p>But, if you do it with a larger, non-<code>tibble</code> data frame, it will attempt print the entire data frame on your console or your knitted output, making the result very difficult to read.</p>
<pre class="r"><code>## demo (compare and contrast regular data frame and tibble)
mpg</code></pre>
<pre><code>## # A tibble: 234 x 11
##    manufacturer model    displ  year   cyl trans   drv     cty   hwy fl    class
##    &lt;chr&gt;        &lt;chr&gt;    &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;   &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;
##  1 audi         a4         1.8  1999     4 auto(l… f        18    29 p     comp…
##  2 audi         a4         1.8  1999     4 manual… f        21    29 p     comp…
##  3 audi         a4         2    2008     4 manual… f        20    31 p     comp…
##  4 audi         a4         2    2008     4 auto(a… f        21    30 p     comp…
##  5 audi         a4         2.8  1999     6 auto(l… f        16    26 p     comp…
##  6 audi         a4         2.8  1999     6 manual… f        18    26 p     comp…
##  7 audi         a4         3.1  2008     6 auto(a… f        18    27 p     comp…
##  8 audi         a4 quat…   1.8  1999     4 manual… 4        18    26 p     comp…
##  9 audi         a4 quat…   1.8  1999     4 auto(l… 4        16    25 p     comp…
## 10 audi         a4 quat…   2    2008     4 manual… 4        20    28 p     comp…
## # … with 224 more rows</code></pre>
<pre class="r"><code>cars</code></pre>
<pre><code>##    speed dist
## 1      4    2
## 2      4   10
## 3      7    4
## 4      7   22
## 5      8   16
## 6      9   10
## 7     10   18
## 8     10   26
## 9     10   34
## 10    11   17
## 11    11   28
## 12    12   14
## 13    12   20
## 14    12   24
## 15    12   28
## 16    13   26
## 17    13   34
## 18    13   34
## 19    13   46
## 20    14   26
## 21    14   36
## 22    14   60
## 23    14   80
## 24    15   20
## 25    15   26
## 26    15   54
## 27    16   32
## 28    16   40
## 29    17   32
## 30    17   40
## 31    17   50
## 32    18   42
## 33    18   56
## 34    18   76
## 35    18   84
## 36    19   36
## 37    19   46
## 38    19   68
## 39    20   32
## 40    20   48
## 41    20   52
## 42    20   56
## 43    20   64
## 44    22   66
## 45    23   54
## 46    24   70
## 47    24   92
## 48    24   93
## 49    24  120
## 50    25   85</code></pre></li>
<li><p><code>View()</code></p>
<p><code>View()</code> opens up a spreadsheet-style data viewer. The resulting spreadsheet can be sorted by clicking the column names. It is good for exploring the dataset, but you should not run <code>View()</code> when knitting a RMarkdown file.</p>
<p>Why do you think that is? Try typing <code>View(mpg)</code> in a code chunk in RMarkdown, knit it, and see what happens.</p>
<pre class="r"><code>## exercise, then demo (knit with View() in code chunk)
## View(mpg)</code></pre></li>
<li><p><code>head()</code> and <code>tail()</code></p>
<p><code>head()</code> and <code>tail()</code> can be used to check the first and last few rows of a data frame.</p>
<pre class="r"><code>## demo
head(mpg)</code></pre>
<pre><code>## # A tibble: 6 x 11
##   manufacturer model displ  year   cyl trans      drv     cty   hwy fl    class 
##   &lt;chr&gt;        &lt;chr&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;      &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; 
## 1 audi         a4      1.8  1999     4 auto(l5)   f        18    29 p     compa…
## 2 audi         a4      1.8  1999     4 manual(m5) f        21    29 p     compa…
## 3 audi         a4      2    2008     4 manual(m6) f        20    31 p     compa…
## 4 audi         a4      2    2008     4 auto(av)   f        21    30 p     compa…
## 5 audi         a4      2.8  1999     6 auto(l5)   f        16    26 p     compa…
## 6 audi         a4      2.8  1999     6 manual(m5) f        18    26 p     compa…</code></pre>
<pre class="r"><code>tail(mpg)</code></pre>
<pre><code>## # A tibble: 6 x 11
##   manufacturer model  displ  year   cyl trans     drv     cty   hwy fl    class 
##   &lt;chr&gt;        &lt;chr&gt;  &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;     &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; 
## 1 volkswagen   passat   1.8  1999     4 auto(l5)  f        18    29 p     midsi…
## 2 volkswagen   passat   2    2008     4 auto(s6)  f        19    28 p     midsi…
## 3 volkswagen   passat   2    2008     4 manual(m… f        21    29 p     midsi…
## 4 volkswagen   passat   2.8  1999     6 auto(l5)  f        16    26 p     midsi…
## 5 volkswagen   passat   2.8  1999     6 manual(m… f        18    26 p     midsi…
## 6 volkswagen   passat   3.6  2008     6 auto(s6)  f        17    26 p     midsi…</code></pre></li>
<li><p><code>?</code></p>
<p>If the data frame included in an R package, typing <code>?data frame_name</code> will lead you to a help file with more information on the data frame.</p></li>
<li><p><code>str()</code>, <code>is()</code>, <code>dim()</code>, <code>colnames()</code>, <code>summary()</code></p>
<p>These functions return important information on the data frame and are particularly helpful when inspecting larger data frames. Give them a try and see what they do.</p>
<pre class="r"><code>## exercise, then demo
str(mpg)</code></pre>
<pre><code>## Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;:    234 obs. of  11 variables:
##  $ manufacturer: chr  &quot;audi&quot; &quot;audi&quot; &quot;audi&quot; &quot;audi&quot; ...
##  $ model       : chr  &quot;a4&quot; &quot;a4&quot; &quot;a4&quot; &quot;a4&quot; ...
##  $ displ       : num  1.8 1.8 2 2 2.8 2.8 3.1 1.8 1.8 2 ...
##  $ year        : int  1999 1999 2008 2008 1999 1999 2008 1999 1999 2008 ...
##  $ cyl         : int  4 4 4 4 6 6 6 4 4 4 ...
##  $ trans       : chr  &quot;auto(l5)&quot; &quot;manual(m5)&quot; &quot;manual(m6)&quot; &quot;auto(av)&quot; ...
##  $ drv         : chr  &quot;f&quot; &quot;f&quot; &quot;f&quot; &quot;f&quot; ...
##  $ cty         : int  18 21 20 21 16 18 18 18 16 20 ...
##  $ hwy         : int  29 29 31 30 26 26 27 26 25 28 ...
##  $ fl          : chr  &quot;p&quot; &quot;p&quot; &quot;p&quot; &quot;p&quot; ...
##  $ class       : chr  &quot;compact&quot; &quot;compact&quot; &quot;compact&quot; &quot;compact&quot; ...</code></pre>
<pre class="r"><code>is(mpg)</code></pre>
<pre><code>## [1] &quot;tbl_df&quot;     &quot;tbl&quot;        &quot;data.frame&quot; &quot;list&quot;       &quot;oldClass&quot;  
## [6] &quot;vector&quot;</code></pre>
<pre class="r"><code>dim(mpg)</code></pre>
<pre><code>## [1] 234  11</code></pre>
<pre class="r"><code>colnames(mpg)</code></pre>
<pre><code>##  [1] &quot;manufacturer&quot; &quot;model&quot;        &quot;displ&quot;        &quot;year&quot;         &quot;cyl&quot;         
##  [6] &quot;trans&quot;        &quot;drv&quot;          &quot;cty&quot;          &quot;hwy&quot;          &quot;fl&quot;          
## [11] &quot;class&quot;</code></pre>
<pre class="r"><code>summary(mpg)</code></pre>
<pre><code>##  manufacturer          model               displ            year     
##  Length:234         Length:234         Min.   :1.600   Min.   :1999  
##  Class :character   Class :character   1st Qu.:2.400   1st Qu.:1999  
##  Mode  :character   Mode  :character   Median :3.300   Median :2004  
##                                        Mean   :3.472   Mean   :2004  
##                                        3rd Qu.:4.600   3rd Qu.:2008  
##                                        Max.   :7.000   Max.   :2008  
##       cyl           trans               drv                 cty       
##  Min.   :4.000   Length:234         Length:234         Min.   : 9.00  
##  1st Qu.:4.000   Class :character   Class :character   1st Qu.:14.00  
##  Median :6.000   Mode  :character   Mode  :character   Median :17.00  
##  Mean   :5.889                                         Mean   :16.86  
##  3rd Qu.:8.000                                         3rd Qu.:19.00  
##  Max.   :8.000                                         Max.   :35.00  
##       hwy             fl               class          
##  Min.   :12.00   Length:234         Length:234        
##  1st Qu.:18.00   Class :character   Class :character  
##  Median :24.00   Mode  :character   Mode  :character  
##  Mean   :23.44                                        
##  3rd Qu.:27.00                                        
##  Max.   :44.00</code></pre></li>
</ul>
</div>
<div id="simple-scatter-plot" class="section level4">
<h4>Simple scatter plot</h4>
<p>Let’s first make a simple scatter plot to look at how engine displacement (<code>displ</code>), which is an expression of an engine’s size, may affect the fuel economy of cars on highway (<code>hwy</code>). For this plot, what are the aesthetics, and what are the geometric objects?</p>
<pre class="r"><code>## demo
ggplot(data = mpg) + 
  geom_point(mapping = aes(x=displ, y=hwy)) </code></pre>
<p><img src="lesson6-ggplot-part1_files/figure-html/unnamed-chunk-6-1.png" /><!-- --></p>
</div>
<div id="make-the-size-of-points-corresponds-to-the-number-of-cylinders-cyl-and-the-color-of-points-corresponds-to-the-type-of-car-class" class="section level4">
<h4>Make the size of points corresponds to the number of cylinders (<code>cyl</code>), and the color of points corresponds to the type of car (<code>class</code>)</h4>
<p>The scatter plot shows that there is a negative correlation between engine size and fuel economy. However, there are a few points that show up as outliers of this general trend. Why might this be?</p>
<p>To explore this further, we will map <code>cyl</code> to <code>size</code>, and <code>class</code> to <code>color</code>.</p>
<pre class="r"><code>## demo
ggplot(data = mpg) + 
  geom_point(mapping = aes(x=displ, y=hwy, color=class, size=cyl)) </code></pre>
<p><img src="lesson6-ggplot-part1_files/figure-html/unnamed-chunk-7-1.png" /><!-- --></p>
<p>Looks like given the same engine size, 2seaters tend to have better fuel economy than other car types. This makes sense.</p>
</div>
<div id="change-the-shape-of-all-points" class="section level4">
<h4>Change the shape of all points</h4>
<p>There is too much overlap among the larger points in the previous graph and we want to use a different point shape (<code>shape</code>) to show these points more clearly. When all points in the graph get the same aesthetic, we are no longer mapping the aesthetic to a variable. Therefore, we should make sure to specify this outside of the <code>mapping</code> argument.</p>
<pre class="r"><code>## demo (change point shape to 1)
ggplot(data = mpg) + 
  geom_point(mapping = aes(x=displ, y=hwy, color=class, size=cyl), shape=1) </code></pre>
<p><img src="lesson6-ggplot-part1_files/figure-html/unnamed-chunk-8-1.png" /><!-- --></p>
</div>
<div id="overlay-two-different-geometric-objects" class="section level4">
<h4>Overlay two different geometric objects</h4>
<p>Here, we will add a trend line to the scatter plot above. We can do this by adding another geometric object (<code>geom_smooth()</code>) on top of the previous graph. Give it a try yourself first.</p>
<pre class="r"><code>## exercise, then demo
ggplot(data = mpg) + 
  geom_point(mapping = aes(x=displ, y=hwy, color=class, size=cyl), shape=1) +
  geom_smooth(mapping = aes(x=displ, y=hwy))</code></pre>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="lesson6-ggplot-part1_files/figure-html/unnamed-chunk-9-1.png" /><!-- --></p>
<p>Did you notice that for both geometric objects, <code>x</code> maps to <code>displ</code> and <code>y</code> maps <code>hwy</code>, so these auguments are repeated? In such cases, we can minimize the amount of repeat by defining how these aesthetics map to variables for all subsequent layers within <code>ggplot()</code>, as the following.</p>
<pre class="r"><code>## demo
ggplot(data = mpg, mapping = aes(x=displ, y=hwy)) + 
  geom_point(mapping = aes(color=class, size=cyl), shape=1) +
  geom_smooth()</code></pre>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="lesson6-ggplot-part1_files/figure-html/unnamed-chunk-10-1.png" /><!-- --></p>
</div>
<div id="display-different-year-in-different-facets" class="section level4">
<h4>Display different <code>year</code> in different facets</h4>
<p>The <code>mpg</code> dataset contains cars made in 1999 and 2008. To check whether the relationship between <code>displ</code> and <code>hwy</code> remains the same across time, we can add a facet function to the previous plot and plot the two years side by side.</p>
<pre class="r"><code>## demo
ggplot(data = mpg, mapping = aes(x=displ, y=hwy)) + 
  geom_point(mapping = aes(color=class, size=cyl), shape=1) +
  geom_smooth() +
  facet_wrap(~year, nrow=1)</code></pre>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="lesson6-ggplot-part1_files/figure-html/unnamed-chunk-11-1.png" /><!-- --></p>
</div>
<div id="adjust-figure-size-using-chunk-options" class="section level4">
<h4>Adjust figure size using chunk options</h4>
<p>Note that each facet in the figure above appears to be quite narrow. To make the figure wider, use RMarkdown chunk options <code>fig.height</code> and <code>fig.width</code>.</p>
<pre class="r"><code>## demo
ggplot(data = mpg, mapping = aes(x=displ, y=hwy)) + 
  geom_point(mapping = aes(color=class, size=cyl), shape=1) +
  geom_smooth() +
  facet_wrap(~year, nrow=1)</code></pre>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="lesson6-ggplot-part1_files/figure-html/unnamed-chunk-12-1.png" /><!-- --></p>
</div>
<div id="change-the-theme-of-a-graph" class="section level4">
<h4>Change the theme of a graph</h4>
<p>While every element of a <code>ggplot2</code> graph is customizable, there are also built-in themes (<code>theme_*()</code>) that you can use to make some major headway before making smaller tweaks manually. Let’s try one of them here.</p>
<pre class="r"><code>## demo (use theme_bw)
ggplot(data = mpg, mapping = aes(x=displ, y=hwy)) + 
  geom_point(mapping = aes(color=class, size=cyl), shape=1) +
  geom_smooth() +
  facet_wrap(~year, nrow=1) +
  theme_bw()</code></pre>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="lesson6-ggplot-part1_files/figure-html/unnamed-chunk-13-1.png" /><!-- --></p>
<p><br></p>
</div>
</div>
<div id="arguments-and-functions-ysk" class="section level2">
<h2>Arguments and functions YSK</h2>
<p>Now, you’ve learned the central ideas behind <code>ggplot2</code>. In the next <code>ggplot2</code> lecture, we will go over some more advanced ggplot2 functionalities (e.g. statistical transformation, position adjustment, coordinate setting, color scaling, theme), but after that, the best way to learn more about <code>ggplot2</code> is often through practice and Google, since the possibilities that you can have with <code>ggplot2</code> are quite limitless, and what you want to achieve with <code>ggplot2</code> often vary among individuals.</p>
<p>With that being said, there are some geometries, aesthetics, and facet functions that are most commonly used and these often serve as the building blocks for more advance usage. Let’s now go through some of these together in class.</p>
<div id="geometries" class="section level4">
<h4>Geometries</h4>
<ul>
<li><p><code>geom_point()</code></p></li>
<li><p><code>geom_boxplot()</code></p>
<pre class="r"><code>## exercise, then demo (hwy vs. class)
ggplot(data = mpg) +
  geom_boxplot(mapping = aes(x=class, y=hwy))</code></pre>
<p><img src="lesson6-ggplot-part1_files/figure-html/unnamed-chunk-14-1.png" /><!-- --></p></li>
<li><p><code>geom_bar()</code></p>
<pre class="r"><code>## exercise, then demo (class)
ggplot(mpg) +
  geom_bar(aes(x=class))</code></pre>
<p><img src="lesson6-ggplot-part1_files/figure-html/unnamed-chunk-15-1.png" /><!-- --></p></li>
<li><p><code>geom_histogram()</code></p>
<pre class="r"><code>## exercise, then demo (hwy)
ggplot(mpg) +
  geom_histogram(aes(x=hwy))</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="lesson6-ggplot-part1_files/figure-html/unnamed-chunk-16-1.png" /><!-- --></p></li>
<li><p><code>geom_density()</code></p>
<pre class="r"><code>## exercise, then demo (hwy)
ggplot(mpg) +
  geom_density(aes(x=hwy))</code></pre>
<p><img src="lesson6-ggplot-part1_files/figure-html/unnamed-chunk-17-1.png" /><!-- --></p></li>
<li><p><code>geom_smooth()</code></p>
<p>Different <code>geom_*()</code> functions have different arguments that can be very helpful. You can learn more about them by reading their help pages. For example, <code>method=&quot;lm&quot;</code> and <code>se=FALSE</code> are two arguments that are often used in the <code>geom_smooth()</code> function.</p>
<pre class="r"><code>## exercise, then demo (fit linear model to hwy vs. displ without confidence interval)
ggplot(mpg, aes(x=displ, y=hwy))+
  geom_point() +
  geom_smooth(method=&quot;lm&quot;, se=F)</code></pre>
<p><img src="lesson6-ggplot-part1_files/figure-html/unnamed-chunk-18-1.png" /><!-- --></p></li>
<li><p><code>geom_text()</code></p>
<pre class="r"><code>## demo (hwy vs. displ, cyl as the label)
ggplot(mpg, aes(x=displ, y=hwy))+
  geom_text(aes(label=cyl))</code></pre>
<p><img src="lesson6-ggplot-part1_files/figure-html/unnamed-chunk-19-1.png" /><!-- --></p></li>
<li><p><code>geom_label()</code></p>
<p>Each geometric object can take a different data frame if specified. Here is an example of that.</p>
<pre class="r"><code>## demo (hwy vs. displ, model as the label but only label points with hwy &gt; 40)
ggplot(mpg)+
  geom_point(aes(x=displ, y=hwy)) +
  geom_label(data=filter(mpg, hwy&gt;40), mapping = aes(label=model, y=hwy, x=displ+0.8))</code></pre>
<p><img src="lesson6-ggplot-part1_files/figure-html/unnamed-chunk-20-1.png" /><!-- --></p></li>
<li><p><code>geom_line()</code></p>
<pre class="r"><code>## demo (change in mean hwy for each car model over time, grouped by model, colored by class, faceted by manufacturer)
group_by(mpg, manufacturer, year, class, model) %&gt;%
  summarize(mean_hwy=mean(hwy)) %&gt;%
  ggplot(aes(x=year, y=mean_hwy, color=class, group=model)) +
  geom_point() +
  geom_line() +
  facet_wrap(~manufacturer)</code></pre>
<p><img src="lesson6-ggplot-part1_files/figure-html/unnamed-chunk-21-1.png" /><!-- --></p></li>
</ul>
</div>
<div id="aesthetics" class="section level4">
<h4>Aesthetics</h4>
<ul>
<li><p><code>x</code>, <code>y</code></p></li>
<li><p><code>size</code></p></li>
<li><p><code>label</code></p></li>
<li><p><code>group</code></p></li>
<li><p><code>color</code>, <code>fill</code></p>
<p><code>color</code> controls the color of points and lines, whereas <code>fill</code> controls the color of surfaces</p>
<pre class="r"><code>## demo (plot hwy distribution with geom_density, color by drv)
ggplot(mpg) +
  geom_density(aes(color=drv, x=hwy))</code></pre>
<p><img src="lesson6-ggplot-part1_files/figure-html/unnamed-chunk-22-1.png" /><!-- --></p>
<pre class="r"><code>## demo (fill by drv)
ggplot(mpg) +
  geom_density(aes(fill=drv, x=hwy))</code></pre>
<p><img src="lesson6-ggplot-part1_files/figure-html/unnamed-chunk-22-2.png" /><!-- --></p></li>
<li><p><code>alpha</code></p>
<p><code>alpha</code> controls tranparency</p>
<pre class="r"><code>## demo (plot hwy distribution with geom_density, fill by drv, set alpha to 0.5)
ggplot(mpg) +
  geom_density(aes(fill=drv, x=hwy), alpha=0.5)</code></pre>
<p><img src="lesson6-ggplot-part1_files/figure-html/unnamed-chunk-23-1.png" /><!-- --></p></li>
<li><p><code>shape</code>, <code>line_type</code></p>
<pre class="r"><code>## demo (hwy vs. displ, geom_point and geom_line, map drv to color, shape, linetype)
ggplot(mpg, aes(x=displ, y=hwy, color=drv, shape=drv)) +
  geom_point()+
  geom_smooth(aes(linetype=drv))</code></pre>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="lesson6-ggplot-part1_files/figure-html/unnamed-chunk-24-1.png" /><!-- --></p></li>
</ul>
</div>
<div id="facet" class="section level4">
<h4>Facet</h4>
<ul>
<li><p><code>facet_wrap()</code></p></li>
<li><p><code>facet grid()</code></p>
<pre class="r"><code>## demo (hwy vs displ, faceted by cyl and drv)
ggplot(mpg, aes(x=displ, y=hwy)) +
  geom_point() +
  facet_grid(drv~cyl)</code></pre>
<p><img src="lesson6-ggplot-part1_files/figure-html/unnamed-chunk-25-1.png" /><!-- --></p></li>
</ul>
<p><br></p>
</div>
</div>
<div id="exercise" class="section level2">
<h2>Exercise</h2>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
